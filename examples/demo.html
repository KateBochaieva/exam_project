<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Демо: 3D-координатна система</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script>
    AFRAME.registerComponent("vector-demo", {
      init: function () {
        const sceneEl = this.el;

        const axes = [
          { dir: [1, 0, 0], color: "red", label: "X" },
          { dir: [0, 1, 0], color: "green", label: "Y" },
          { dir: [0, 0, -1], color: "blue", label: "Z" },
        ];

        axes.forEach((axis) => {
          const line = document.createElement("a-entity");
          line.setAttribute("geometry", {
            primitive: "cylinder",
            radius: 0.01,
            height: Math.sqrt(axis.dir[0]**2 + axis.dir[1]**2 + axis.dir[2]**2),
          });
          line.setAttribute("material", "color", axis.color);
          line.setAttribute("position", `${axis.dir[0]/2} ${axis.dir[1]/2} ${axis.dir[2]/2}`);
          line.setAttribute("rotation", `${Math.atan2(axis.dir[1], axis.dir[2]) * 180 / Math.PI} ${Math.atan2(axis.dir[0], axis.dir[2]) * 180 / Math.PI} 0`);
          sceneEl.appendChild(line);

          const label = document.createElement("a-text");
          label.setAttribute("value", axis.label);
          label.setAttribute("color", axis.color);
          label.setAttribute("position", axis.dir.map((x) => x * 1.2).join(" "));
          label.setAttribute("align", "center");
          label.setAttribute("scale", "0.5 0.5 0.5");
          sceneEl.appendChild(label);
        });

        const A = new AFRAME.THREE.Vector3(1, 1, 0);
        const B = new AFRAME.THREE.Vector3(0, 1, -1);

        this.drawVector(sceneEl, A, "orange", "A");
        this.drawVector(sceneEl, B, "purple", "B");

        const sum = new AFRAME.THREE.Vector3().addVectors(A, B);
        this.drawVector(sceneEl, sum, "cyan", "A+B");

        const dot = A.dot(B);
        const dotText = document.createElement("a-text");
        dotText.setAttribute("value", `Скалярний добуток A•B = ${dot.toFixed(2)}`);
        dotText.setAttribute("position", "0 2.5 -2");
        dotText.setAttribute("color", "white");
        dotText.setAttribute("scale", "0.6 0.6 0.6");
        sceneEl.appendChild(dotText);

        const cross = new AFRAME.THREE.Vector3().crossVectors(A, B);
        this.drawVector(sceneEl, cross, "yellow", "A×B");
      },

      drawVector(scene, vec, color, name) {
        const shaft = document.createElement("a-entity");
        const length = vec.length();
        const position = vec.clone().multiplyScalar(0.5);
        shaft.setAttribute("geometry", {
          primitive: "cylinder",
          radius: 0.02,
          height: length
        });
        shaft.setAttribute("material", "color", color);
        shaft.setAttribute("position", `${position.x} ${position.y} ${position.z}`);

        // Оцінка кута обертання по осі
        const direction = new AFRAME.THREE.Vector3(vec.x, vec.y, vec.z).normalize();
        const quaternion = new AFRAME.THREE.Quaternion();
        quaternion.setFromUnitVectors(new AFRAME.THREE.Vector3(0, 1, 0), direction);
        const rotation = new AFRAME.THREE.Euler().setFromQuaternion(quaternion, 'XYZ');
        shaft.setAttribute("rotation", `${AFRAME.THREE.Math.radToDeg(rotation.x)} ${AFRAME.THREE.Math.radToDeg(rotation.y)} ${AFRAME.THREE.Math.radToDeg(rotation.z)}`);

        scene.appendChild(shaft);

        const label = document.createElement("a-text");
        label.setAttribute("value", name);
        label.setAttribute("position", `${vec.x} ${vec.y + 0.2} ${vec.z}`);
        label.setAttribute("color", color);
        label.setAttribute("scale", "0.4 0.4 0.4");
        scene.appendChild(label);
      },
    });
  </script>
</head>
<body>
  <a-scene vector-demo background="color: black">
    <a-entity camera position="0 2 5" look-controls></a-entity>
    <a-light type="ambient" intensity="0.5"></a-light>
    <a-light type="directional" position="1 1 0" intensity="1"></a-light>
    <a-plane rotation="-90 0 0" width="10" height="10" color="#222" shadow></a-plane>
  </a-scene>
</body>
</html>


